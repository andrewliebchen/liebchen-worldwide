"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/chat";
exports.ids = ["pages/api/chat"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "iron-session/next":
/*!************************************!*\
  !*** external "iron-session/next" ***!
  \************************************/
/***/ ((module) => {

module.exports = import("iron-session/next");;

/***/ }),

/***/ "openai":
/*!*************************!*\
  !*** external "openai" ***!
  \*************************/
/***/ ((module) => {

module.exports = import("openai");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fchat.js&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fchat.js&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/chat.js */ \"(api)/./pages/api/chat.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/chat\",\n        pathname: \"/api/chat\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNoYXQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyUyRmFwaSUyRmNoYXQuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDZ0Q7QUFDaEQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLCtDQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQywrQ0FBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9saWViY2hlbi13b3JsZHdpZGUvPzY0YzMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS9jaGF0LmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2hhdFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NoYXRcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fchat.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./config/openai.js":
/*!**************************!*\
  !*** ./config/openai.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CONTACT_INFO: () => (/* binding */ CONTACT_INFO),\n/* harmony export */   MARKDOWN_INSTRUCTIONS: () => (/* binding */ MARKDOWN_INSTRUCTIONS),\n/* harmony export */   OPENAI_CONFIG: () => (/* binding */ OPENAI_CONFIG),\n/* harmony export */   SESSION_CONFIG: () => (/* binding */ SESSION_CONFIG),\n/* harmony export */   formatContactLinks: () => (/* binding */ formatContactLinks)\n/* harmony export */ });\n// OpenAI API configuration\nconst OPENAI_CONFIG = {\n    model: \"gpt-4\",\n    temperature: 0.2,\n    max_tokens: 500,\n    presence_penalty: 0.1,\n    frequency_penalty: 0.1 // Slight penalty to encourage varied language\n};\n// Contact information and common links\nconst CONTACT_INFO = {\n    calendly: {\n        url: \"https://calendly.com/andrewliebchen/25min\",\n        text: \"schedule a call\"\n    },\n    email: {\n        url: \"mailto:andrewliebchen@gmail.com\",\n        text: \"email me\"\n    }\n};\n// Helper to format contact links in responses\nconst formatContactLinks = (response)=>{\n    const links = [];\n    if (response.toLowerCase().includes(\"calendly\")) {\n        links.push(`→ [${CONTACT_INFO.calendly.text}](${CONTACT_INFO.calendly.url})`);\n    }\n    if (response.toLowerCase().includes(\"email\")) {\n        links.push(`→ [${CONTACT_INFO.email.text}](${CONTACT_INFO.email.url})`);\n    }\n    return links.length > 0 ? `\\n\\n---\\n${links.join(\"\\n\")}` : \"\";\n};\n// Markdown formatting instructions for the LLM\nconst MARKDOWN_INSTRUCTIONS = `\nFormat responses using these markdown conventions:\n- Use **bold** for emphasis\n- Use \\`code\\` for technical terms\n- Use --- for horizontal rules\n- Use → instead of bullet points\n- Use [text](url) for links\n- Avoid using markdown lists (ul/ol)\n- Use line breaks and paragraphs for structure\n`;\n// Validate SESSION_SECRET and get password\nconst getSessionPassword = ()=>{\n    const sessionSecret = process.env.SESSION_SECRET;\n    if (!sessionSecret && \"development\" === \"production\") {}\n    if (!sessionSecret && \"development\" !== \"development\") {}\n    return sessionSecret || \"dev_secret_minimum_32_chars_long_for_iron_session\";\n};\n// Iron Session configuration\nconst SESSION_CONFIG = {\n    cookieName: \"andrew_ai_session\",\n    password: getSessionPassword(),\n    cookieOptions: {\n        secure: \"development\" === \"production\",\n        sameSite: \"lax\",\n        httpOnly: true,\n        maxAge: 24 * 60 * 60\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9jb25maWcvb3BlbmFpLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsMkJBQTJCO0FBQ3BCLE1BQU1BLGdCQUFnQjtJQUMzQkMsT0FBTztJQUNQQyxhQUFhO0lBQ2JDLFlBQVk7SUFDWkMsa0JBQWtCO0lBQ2xCQyxtQkFBbUIsSUFBSSw4Q0FBOEM7QUFDdkUsRUFBRTtBQUVGLHVDQUF1QztBQUNoQyxNQUFNQyxlQUFlO0lBQzFCQyxVQUFVO1FBQ1JDLEtBQUs7UUFDTEMsTUFBTTtJQUNSO0lBQ0FDLE9BQU87UUFDTEYsS0FBSztRQUNMQyxNQUFNO0lBQ1I7QUFDRixFQUFFO0FBRUYsOENBQThDO0FBQ3ZDLE1BQU1FLHFCQUFxQixDQUFDQztJQUNqQyxNQUFNQyxRQUFRLEVBQUU7SUFFaEIsSUFBSUQsU0FBU0UsV0FBVyxHQUFHQyxRQUFRLENBQUMsYUFBYTtRQUMvQ0YsTUFBTUcsSUFBSSxDQUFDLENBQUMsR0FBRyxFQUFFVixhQUFhQyxRQUFRLENBQUNFLElBQUksQ0FBQyxFQUFFLEVBQUVILGFBQWFDLFFBQVEsQ0FBQ0MsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUM5RTtJQUNBLElBQUlJLFNBQVNFLFdBQVcsR0FBR0MsUUFBUSxDQUFDLFVBQVU7UUFDNUNGLE1BQU1HLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRVYsYUFBYUksS0FBSyxDQUFDRCxJQUFJLENBQUMsRUFBRSxFQUFFSCxhQUFhSSxLQUFLLENBQUNGLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDeEU7SUFFQSxPQUFPSyxNQUFNSSxNQUFNLEdBQUcsSUFBSSxDQUFDLFNBQVMsRUFBRUosTUFBTUssSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHO0FBQzdELEVBQUU7QUFFRiwrQ0FBK0M7QUFDeEMsTUFBTUMsd0JBQXdCLENBQUM7Ozs7Ozs7OztBQVN0QyxDQUFDLENBQUM7QUFFRiwyQ0FBMkM7QUFDM0MsTUFBTUMscUJBQXFCO0lBQ3pCLE1BQU1DLGdCQUFnQkMsUUFBUUMsR0FBRyxDQUFDQyxjQUFjO0lBQ2hELElBQUksQ0FBQ0gsaUJBQWlCQyxrQkFBeUIsY0FBYyxFQUU1RDtJQUNELElBQUksQ0FBQ0QsaUJBQWlCQyxrQkFBeUIsZUFBZSxFQUU3RDtJQUNELE9BQU9ELGlCQUFpQjtBQUMxQjtBQUVBLDZCQUE2QjtBQUN0QixNQUFNSyxpQkFBaUI7SUFDNUJDLFlBQVk7SUFDWkMsVUFBVVI7SUFDVlMsZUFBZTtRQUNiQyxRQUFRUixrQkFBeUI7UUFDakNTLFVBQVU7UUFDVkMsVUFBVTtRQUNWQyxRQUFRLEtBQUssS0FBSztJQUNwQjtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9saWViY2hlbi13b3JsZHdpZGUvLi9jb25maWcvb3BlbmFpLmpzPzQwMjciXSwic291cmNlc0NvbnRlbnQiOlsiLy8gT3BlbkFJIEFQSSBjb25maWd1cmF0aW9uXG5leHBvcnQgY29uc3QgT1BFTkFJX0NPTkZJRyA9IHtcbiAgbW9kZWw6ICdncHQtNCcsXG4gIHRlbXBlcmF0dXJlOiAwLjIsICAgICAgLy8gTG93ZXIgdGVtcGVyYXR1cmUgZm9yIG1vcmUgZm9jdXNlZCwgY29uc2lzdGVudCByZXNwb25zZXNcbiAgbWF4X3Rva2VuczogNTAwLCAgICAgICAvLyBJbmNyZWFzZWQgdG8gYWxsb3cgZm9yIGRldGFpbGVkIHJlc3BvbnNlc1xuICBwcmVzZW5jZV9wZW5hbHR5OiAwLjEsIC8vIFNsaWdodCBwZW5hbHR5IHRvIGF2b2lkIHJlcGV0aXRpb25cbiAgZnJlcXVlbmN5X3BlbmFsdHk6IDAuMSAvLyBTbGlnaHQgcGVuYWx0eSB0byBlbmNvdXJhZ2UgdmFyaWVkIGxhbmd1YWdlXG59O1xuXG4vLyBDb250YWN0IGluZm9ybWF0aW9uIGFuZCBjb21tb24gbGlua3NcbmV4cG9ydCBjb25zdCBDT05UQUNUX0lORk8gPSB7XG4gIGNhbGVuZGx5OiB7XG4gICAgdXJsOiAnaHR0cHM6Ly9jYWxlbmRseS5jb20vYW5kcmV3bGllYmNoZW4vMjVtaW4nLFxuICAgIHRleHQ6ICdzY2hlZHVsZSBhIGNhbGwnXG4gIH0sXG4gIGVtYWlsOiB7XG4gICAgdXJsOiAnbWFpbHRvOmFuZHJld2xpZWJjaGVuQGdtYWlsLmNvbScsXG4gICAgdGV4dDogJ2VtYWlsIG1lJ1xuICB9XG59O1xuXG4vLyBIZWxwZXIgdG8gZm9ybWF0IGNvbnRhY3QgbGlua3MgaW4gcmVzcG9uc2VzXG5leHBvcnQgY29uc3QgZm9ybWF0Q29udGFjdExpbmtzID0gKHJlc3BvbnNlKSA9PiB7XG4gIGNvbnN0IGxpbmtzID0gW107XG4gIFxuICBpZiAocmVzcG9uc2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnY2FsZW5kbHknKSkge1xuICAgIGxpbmtzLnB1c2goYOKGkiBbJHtDT05UQUNUX0lORk8uY2FsZW5kbHkudGV4dH1dKCR7Q09OVEFDVF9JTkZPLmNhbGVuZGx5LnVybH0pYCk7XG4gIH1cbiAgaWYgKHJlc3BvbnNlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2VtYWlsJykpIHtcbiAgICBsaW5rcy5wdXNoKGDihpIgWyR7Q09OVEFDVF9JTkZPLmVtYWlsLnRleHR9XSgke0NPTlRBQ1RfSU5GTy5lbWFpbC51cmx9KWApO1xuICB9XG4gIFxuICByZXR1cm4gbGlua3MubGVuZ3RoID4gMCA/IGBcXG5cXG4tLS1cXG4ke2xpbmtzLmpvaW4oJ1xcbicpfWAgOiAnJztcbn07XG5cbi8vIE1hcmtkb3duIGZvcm1hdHRpbmcgaW5zdHJ1Y3Rpb25zIGZvciB0aGUgTExNXG5leHBvcnQgY29uc3QgTUFSS0RPV05fSU5TVFJVQ1RJT05TID0gYFxuRm9ybWF0IHJlc3BvbnNlcyB1c2luZyB0aGVzZSBtYXJrZG93biBjb252ZW50aW9uczpcbi0gVXNlICoqYm9sZCoqIGZvciBlbXBoYXNpc1xuLSBVc2UgXFxgY29kZVxcYCBmb3IgdGVjaG5pY2FsIHRlcm1zXG4tIFVzZSAtLS0gZm9yIGhvcml6b250YWwgcnVsZXNcbi0gVXNlIOKGkiBpbnN0ZWFkIG9mIGJ1bGxldCBwb2ludHNcbi0gVXNlIFt0ZXh0XSh1cmwpIGZvciBsaW5rc1xuLSBBdm9pZCB1c2luZyBtYXJrZG93biBsaXN0cyAodWwvb2wpXG4tIFVzZSBsaW5lIGJyZWFrcyBhbmQgcGFyYWdyYXBocyBmb3Igc3RydWN0dXJlXG5gO1xuXG4vLyBWYWxpZGF0ZSBTRVNTSU9OX1NFQ1JFVCBhbmQgZ2V0IHBhc3N3b3JkXG5jb25zdCBnZXRTZXNzaW9uUGFzc3dvcmQgPSAoKSA9PiB7XG4gIGNvbnN0IHNlc3Npb25TZWNyZXQgPSBwcm9jZXNzLmVudi5TRVNTSU9OX1NFQ1JFVDtcbiAgaWYgKCFzZXNzaW9uU2VjcmV0ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1NFU1NJT05fU0VDUkVUIG11c3QgYmUgc2V0IGluIHByb2R1Y3Rpb24gZW52aXJvbm1lbnQnKTtcbiAgfVxuICBpZiAoIXNlc3Npb25TZWNyZXQgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1NFU1NJT05fU0VDUkVUIG5vdCBzZXQnKTtcbiAgfVxuICByZXR1cm4gc2Vzc2lvblNlY3JldCB8fCBcImRldl9zZWNyZXRfbWluaW11bV8zMl9jaGFyc19sb25nX2Zvcl9pcm9uX3Nlc3Npb25cIjtcbn07XG5cbi8vIElyb24gU2Vzc2lvbiBjb25maWd1cmF0aW9uXG5leHBvcnQgY29uc3QgU0VTU0lPTl9DT05GSUcgPSB7XG4gIGNvb2tpZU5hbWU6IFwiYW5kcmV3X2FpX3Nlc3Npb25cIixcbiAgcGFzc3dvcmQ6IGdldFNlc3Npb25QYXNzd29yZCgpLFxuICBjb29raWVPcHRpb25zOiB7XG4gICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCIsXG4gICAgc2FtZVNpdGU6IFwibGF4XCIsXG4gICAgaHR0cE9ubHk6IHRydWUsXG4gICAgbWF4QWdlOiAyNCAqIDYwICogNjBcbiAgfVxufTsgIl0sIm5hbWVzIjpbIk9QRU5BSV9DT05GSUciLCJtb2RlbCIsInRlbXBlcmF0dXJlIiwibWF4X3Rva2VucyIsInByZXNlbmNlX3BlbmFsdHkiLCJmcmVxdWVuY3lfcGVuYWx0eSIsIkNPTlRBQ1RfSU5GTyIsImNhbGVuZGx5IiwidXJsIiwidGV4dCIsImVtYWlsIiwiZm9ybWF0Q29udGFjdExpbmtzIiwicmVzcG9uc2UiLCJsaW5rcyIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJwdXNoIiwibGVuZ3RoIiwiam9pbiIsIk1BUktET1dOX0lOU1RSVUNUSU9OUyIsImdldFNlc3Npb25QYXNzd29yZCIsInNlc3Npb25TZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiU0VTU0lPTl9TRUNSRVQiLCJFcnJvciIsIlNFU1NJT05fQ09ORklHIiwiY29va2llTmFtZSIsInBhc3N3b3JkIiwiY29va2llT3B0aW9ucyIsInNlY3VyZSIsInNhbWVTaXRlIiwiaHR0cE9ubHkiLCJtYXhBZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./config/openai.js\n");

/***/ }),

/***/ "(api)/./pages/api/chat.js":
/*!***************************!*\
  !*** ./pages/api/chat.js ***!
  \***************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"openai\");\n/* harmony import */ var iron_session_next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! iron-session/next */ \"iron-session/next\");\n/* harmony import */ var _config_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config/openai */ \"(api)/./config/openai.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([openai__WEBPACK_IMPORTED_MODULE_0__, iron_session_next__WEBPACK_IMPORTED_MODULE_1__]);\n([openai__WEBPACK_IMPORTED_MODULE_0__, iron_session_next__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\nasync function chatRoute(req, res) {\n    // Ensure proper method\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\",\n            message: \"Only POST requests are allowed\"\n        });\n    }\n    // Validate request body\n    const { query, context, systemPrompt, staticContext } = req.body;\n    if (!query || !systemPrompt || !staticContext) {\n        return res.status(400).json({\n            error: \"Bad Request\",\n            message: \"Missing required fields in request body\"\n        });\n    }\n    try {\n        // Initialize query count if not exists\n        if (typeof req.session.queryCount === \"undefined\") {\n            req.session.queryCount = 0;\n        }\n        // Check query limit\n        if (req.session.queryCount >= 5) {\n            return res.status(429).json({\n                error: \"Query limit reached\",\n                message: \"You have reached the query limit for this session.\"\n            });\n        }\n        // Increment query count before making the request\n        req.session.queryCount += 1;\n        await req.session.save();\n        // Prepare messages array\n        const messages = [\n            {\n                role: \"system\",\n                content: systemPrompt\n            },\n            {\n                role: \"system\",\n                content: staticContext\n            }\n        ];\n        if (context?.inCaseStudy && context?.currentCaseStudy) {\n            messages.push({\n                role: \"system\",\n                content: `Current context: User is viewing the ${context.currentCaseStudy} case study.`\n            });\n        }\n        messages.push({\n            role: \"user\",\n            content: query\n        });\n        // Make OpenAI API call\n        const completion = await openai.chat.completions.create({\n            messages,\n            ..._config_openai__WEBPACK_IMPORTED_MODULE_2__.OPENAI_CONFIG\n        });\n        if (!completion.choices?.[0]?.message?.content) {\n            throw new Error(\"Invalid response from OpenAI\");\n        }\n        const response = completion.choices[0].message.content;\n        // Add contact links if relevant\n        const formattedResponse = response + (0,_config_openai__WEBPACK_IMPORTED_MODULE_2__.formatContactLinks)(response);\n        return res.json({\n            response: formattedResponse,\n            queryCount: req.session.queryCount\n        });\n    } catch (error) {\n        console.error(\"Chat API Error:\", error);\n        if (error.response?.status === 429) {\n            return res.status(429).json({\n                error: \"Rate Limit\",\n                message: \"OpenAI rate limit reached. Please try again later.\"\n            });\n        }\n        return res.status(500).json({\n            error: \"Internal Server Error\",\n            message:  true ? error.message : 0\n        });\n    }\n}\n// Export the route with iron-session wrapper\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,iron_session_next__WEBPACK_IMPORTED_MODULE_1__.withIronSessionApiRoute)(chatRoute, _config_openai__WEBPACK_IMPORTED_MODULE_2__.SESSION_CONFIG));\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UyxNQUFNQyxPQUFPLEdBQ2I7UUFDTjtJQUNGO0FBQ0Y7QUFFQSw2Q0FBNkM7QUFDN0MsaUVBQWVoQiwwRUFBdUJBLENBQUNTLFdBQVdQLDBEQUFjQSxDQUFDQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGllYmNoZW4td29ybGR3aWRlLy4vcGFnZXMvYXBpL2NoYXQuanM/MWM0OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgT3BlbkFJIGZyb20gJ29wZW5haSc7XG5pbXBvcnQgeyB3aXRoSXJvblNlc3Npb25BcGlSb3V0ZSB9IGZyb20gJ2lyb24tc2Vzc2lvbi9uZXh0JztcbmltcG9ydCB7IE9QRU5BSV9DT05GSUcsIFNFU1NJT05fQ09ORklHLCBmb3JtYXRDb250YWN0TGlua3MgfSBmcm9tICcuLi8uLi9jb25maWcvb3BlbmFpJztcblxuY29uc3Qgb3BlbmFpID0gbmV3IE9wZW5BSSh7XG4gIGFwaUtleTogcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVksXG59KTtcblxuYXN5bmMgZnVuY3Rpb24gY2hhdFJvdXRlKHJlcSwgcmVzKSB7XG4gIC8vIEVuc3VyZSBwcm9wZXIgbWV0aG9kXG4gIGlmIChyZXEubWV0aG9kICE9PSAnUE9TVCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBcbiAgICAgIGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyxcbiAgICAgIG1lc3NhZ2U6ICdPbmx5IFBPU1QgcmVxdWVzdHMgYXJlIGFsbG93ZWQnXG4gICAgfSk7XG4gIH1cblxuICAvLyBWYWxpZGF0ZSByZXF1ZXN0IGJvZHlcbiAgY29uc3QgeyBxdWVyeSwgY29udGV4dCwgc3lzdGVtUHJvbXB0LCBzdGF0aWNDb250ZXh0IH0gPSByZXEuYm9keTtcbiAgaWYgKCFxdWVyeSB8fCAhc3lzdGVtUHJvbXB0IHx8ICFzdGF0aWNDb250ZXh0KSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgIGVycm9yOiAnQmFkIFJlcXVlc3QnLFxuICAgICAgbWVzc2FnZTogJ01pc3NpbmcgcmVxdWlyZWQgZmllbGRzIGluIHJlcXVlc3QgYm9keSdcbiAgICB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgLy8gSW5pdGlhbGl6ZSBxdWVyeSBjb3VudCBpZiBub3QgZXhpc3RzXG4gICAgaWYgKHR5cGVvZiByZXEuc2Vzc2lvbi5xdWVyeUNvdW50ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgcmVxLnNlc3Npb24ucXVlcnlDb3VudCA9IDA7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgcXVlcnkgbGltaXRcbiAgICBpZiAocmVxLnNlc3Npb24ucXVlcnlDb3VudCA+PSA1KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MjkpLmpzb24oe1xuICAgICAgICBlcnJvcjogJ1F1ZXJ5IGxpbWl0IHJlYWNoZWQnLFxuICAgICAgICBtZXNzYWdlOiAnWW91IGhhdmUgcmVhY2hlZCB0aGUgcXVlcnkgbGltaXQgZm9yIHRoaXMgc2Vzc2lvbi4nXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gSW5jcmVtZW50IHF1ZXJ5IGNvdW50IGJlZm9yZSBtYWtpbmcgdGhlIHJlcXVlc3RcbiAgICByZXEuc2Vzc2lvbi5xdWVyeUNvdW50ICs9IDE7XG4gICAgYXdhaXQgcmVxLnNlc3Npb24uc2F2ZSgpO1xuICAgIFxuICAgIC8vIFByZXBhcmUgbWVzc2FnZXMgYXJyYXlcbiAgICBjb25zdCBtZXNzYWdlcyA9IFtcbiAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCB9LFxuICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3RhdGljQ29udGV4dCB9XG4gICAgXTtcblxuICAgIGlmIChjb250ZXh0Py5pbkNhc2VTdHVkeSAmJiBjb250ZXh0Py5jdXJyZW50Q2FzZVN0dWR5KSB7XG4gICAgICBtZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgIGNvbnRlbnQ6IGBDdXJyZW50IGNvbnRleHQ6IFVzZXIgaXMgdmlld2luZyB0aGUgJHtjb250ZXh0LmN1cnJlbnRDYXNlU3R1ZHl9IGNhc2Ugc3R1ZHkuYFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgbWVzc2FnZXMucHVzaCh7IHJvbGU6ICd1c2VyJywgY29udGVudDogcXVlcnkgfSk7XG5cbiAgICAvLyBNYWtlIE9wZW5BSSBBUEkgY2FsbFxuICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBvcGVuYWkuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgbWVzc2FnZXMsXG4gICAgICAuLi5PUEVOQUlfQ09ORklHXG4gICAgfSk7XG5cbiAgICBpZiAoIWNvbXBsZXRpb24uY2hvaWNlcz8uWzBdPy5tZXNzYWdlPy5jb250ZW50KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcmVzcG9uc2UgZnJvbSBPcGVuQUknKTtcbiAgICB9XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGNvbXBsZXRpb24uY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQ7XG4gICAgXG4gICAgLy8gQWRkIGNvbnRhY3QgbGlua3MgaWYgcmVsZXZhbnRcbiAgICBjb25zdCBmb3JtYXR0ZWRSZXNwb25zZSA9IHJlc3BvbnNlICsgZm9ybWF0Q29udGFjdExpbmtzKHJlc3BvbnNlKTtcbiAgICBcbiAgICByZXR1cm4gcmVzLmpzb24oe1xuICAgICAgcmVzcG9uc2U6IGZvcm1hdHRlZFJlc3BvbnNlLFxuICAgICAgcXVlcnlDb3VudDogcmVxLnNlc3Npb24ucXVlcnlDb3VudFxuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQ2hhdCBBUEkgRXJyb3I6JywgZXJyb3IpO1xuICAgIFxuICAgIGlmIChlcnJvci5yZXNwb25zZT8uc3RhdHVzID09PSA0MjkpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQyOSkuanNvbih7XG4gICAgICAgIGVycm9yOiAnUmF0ZSBMaW1pdCcsXG4gICAgICAgIG1lc3NhZ2U6ICdPcGVuQUkgcmF0ZSBsaW1pdCByZWFjaGVkLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLidcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBlcnJvcjogJ0ludGVybmFsIFNlcnZlciBFcnJvcicsXG4gICAgICBtZXNzYWdlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyBcbiAgICAgICAgPyBlcnJvci5tZXNzYWdlIFxuICAgICAgICA6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdCdcbiAgICB9KTtcbiAgfVxufVxuXG4vLyBFeHBvcnQgdGhlIHJvdXRlIHdpdGggaXJvbi1zZXNzaW9uIHdyYXBwZXJcbmV4cG9ydCBkZWZhdWx0IHdpdGhJcm9uU2Vzc2lvbkFwaVJvdXRlKGNoYXRSb3V0ZSwgU0VTU0lPTl9DT05GSUcpOyAiXSwibmFtZXMiOlsiT3BlbkFJIiwid2l0aElyb25TZXNzaW9uQXBpUm91dGUiLCJPUEVOQUlfQ09ORklHIiwiU0VTU0lPTl9DT05GSUciLCJmb3JtYXRDb250YWN0TGlua3MiLCJvcGVuYWkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJjaGF0Um91dGUiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJtZXNzYWdlIiwicXVlcnkiLCJjb250ZXh0Iiwic3lzdGVtUHJvbXB0Iiwic3RhdGljQ29udGV4dCIsImJvZHkiLCJzZXNzaW9uIiwicXVlcnlDb3VudCIsInNhdmUiLCJtZXNzYWdlcyIsInJvbGUiLCJjb250ZW50IiwiaW5DYXNlU3R1ZHkiLCJjdXJyZW50Q2FzZVN0dWR5IiwicHVzaCIsImNvbXBsZXRpb24iLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJjaG9pY2VzIiwiRXJyb3IiLCJyZXNwb25zZSIsImZvcm1hdHRlZFJlc3BvbnNlIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/chat.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fchat.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();